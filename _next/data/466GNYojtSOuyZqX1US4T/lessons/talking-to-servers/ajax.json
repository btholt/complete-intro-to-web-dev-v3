{"pageProps":{"post":{"attributes":{"description":"","title":"AJAX"},"html":"<p>What is an API? An application programming interface is a URL that you can make requests to get information back from. It&#39;s like website but only for machines. It&#39;s a method that one computer can request information from another.</p>\n<blockquote>\n<p>Note that API is also used to describe how something is used. If I wrote a dog object in JavaScript and gave it two methods: <code>eat()</code> and <code>bark()</code>, you could call those two methods its &quot;API&quot;. A similar but slightly different meaning for the word. I just point that out because it can be confusing. For the rest of this course, we&#39;re talking about endpoints that we can call to get data from.</p>\n</blockquote>\n<p>Now that we speak the language of APIs, let&#39;s dive into making some server requests. Let&#39;s walk through the hypothetical process.</p>\n<p>Let&#39;s say you&#39;re making a weather page where the user enters their zip code and gets back their forecast for the day.</p>\n<ol>\n<li>The user navigates to your page and the page loads.</li>\n<li>The user types <code>98109</code> into the search bar and hits enter</li>\n<li>Your app makes a request to <code>api.example.com/weather?zip=98109</code></li>\n<li>The API response <code>{ &quot;temperature&quot;: 75, units: &quot;F&quot; }</code></li>\n<li>Your app decodes the string to an object using <code>JSON.parse</code></li>\n<li>Your app updates the page to say &quot;The current weather is 75ÂºF&quot;</li>\n</ol>\n<p>So let&#39;s dive into a few things:</p>\n<ul>\n<li>Who is makes the API? It depends. It could be you; your frontend could be requesting against a server you yourself wrote (a topic for a different class.) Or it could be against a myriad of public and free APIs. Or it could be a service you pay for.</li>\n<li><a href=\"https://github.com/toddmotto/public-apis\">Check out these publically available APIs</a>. <a href=\"https://dog.ceo/dog-api/\">dog.ceo</a> is a favorite of mine.</li>\n<li>In our case, we&#39;re going to make requests an API that Frontend Masters maintains for us. <a href=\"http://pets-v2.dev-apis.com/pets\">See here</a> to see an example request.</li>\n<li>Whats is the <code>?zip=98109</code> part of the request. This is called a query string. It allows us to send parameters to a request (like sending parameters to a function) that it can use. In that case, we&#39;re sending the zip code we want the weather for. If you want multiple queries, they are separated by an <code>&amp;</code> e.g. <code>example.com/weather?zip=98109&amp;day=tomorrow</code>.</li>\n<li>What variables you send via querystring will be determined by the API.</li>\n</ul>\n<p>Okay, so let&#39;s make our first request to the dog API. I&#39;m going to be attaching this to a button so we don&#39;t hammer our poor friend&#39;s APIs. Running these APIs isn&#39;t free.</p>\n<blockquote>\n<p>I don&#39;t take responsibility for what images this gives back. They should all just be cute pups.</p>\n</blockquote>\n<pre><code class=\"hljs language-display-html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;dog-btn&quot;</span>&gt;</span>Gimme Doggo<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;dog-target&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n</code></pre>\n<p><button id=\"dog-btn\">Gimme Doggo</button></p>\n<div id=\"dog-target\"></div>\n\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">DOG_URL</span> = <span class=\"hljs-string\">&quot;https://dog.ceo/api/breeds/image/random&quot;</span>;\n\n<span class=\"hljs-keyword\">const</span> doggos = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&quot;dog-target&quot;</span>);\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">addNewDoggo</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">const</span> promise = <span class=\"hljs-title function_\">fetch</span>(<span class=\"hljs-variable constant_\">DOG_URL</span>);\n  promise\n    .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">response</span>) {\n      <span class=\"hljs-keyword\">const</span> processingPromise = response.<span class=\"hljs-title function_\">text</span>();\n      <span class=\"hljs-keyword\">return</span> processingPromise;\n    })\n    .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">processedResponse</span>) {\n      <span class=\"hljs-keyword\">const</span> dogObject = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(processedResponse);\n      <span class=\"hljs-keyword\">const</span> img = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">&quot;img&quot;</span>);\n      img.<span class=\"hljs-property\">src</span> = dogObject.<span class=\"hljs-property\">message</span>;\n      img.<span class=\"hljs-property\">alt</span> = <span class=\"hljs-string\">&quot;Cute doggo&quot;</span>;\n      doggos.<span class=\"hljs-title function_\">appendChild</span>(img);\n    });\n}\n\n<span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&quot;dog-btn&quot;</span>).<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&quot;click&quot;</span>, addNewDoggo);\n</code></pre>\n<p>Let&#39;s dissect this.</p>\n<p>Requests take time. The process of calling out to the Internet, reaching the server, the server processing, responding, and coming back takes time. It could be very fast. It could be a minute. You don&#39;t know until it happens. You need to have the ability to <em>wait</em> in your code. This is called async code, the A in AJAX.</p>\n<p>JavaScript has several ways of dealing with this. We&#39;re using a way called promises. A promise represents a future value. With a promise, you can give it a function with its <code>then</code> function to run whenever it gets its answer back. In this case, we say &quot;hey, you&#39;re going to get some text back from this API, so we need that text.</p>\n<p><code>fetch</code> is a function (builtin for the browser) that allows you to give it a URL like <code>https://dog.ceo/api/breeds/image/random</code> and it will try to get information from that API. In this case we&#39;re asking for a random image of a dog.</p>\n<p><code>fetch</code> gives you back a promise. Then we need to tell it what we think the API is going to send us back. In our case we&#39;re saying it&#39;s going to be <code>text()</code> from the API. There are others (and I&#39;ll show you one in a sec.)</p>\n<p>You can do what&#39;s called <strong>promise chaining</strong>. This allows you to do one async action after another. In our case, we don&#39;t know how long it will take to transform our response into text (it&#39;s basically instant and usually is but it could not be). In any case, by <strong>returning the promise</strong> at the end of the first <code>then</code>, we then can use its data in the second <code>then</code>. That&#39;s why that&#39;s weird that way.</p>\n<p>In the second <code>then</code> we read the <code>message</code> which has the URL, we create an <code>img</code> tag, and append it to the DOM. The result is we get a cool dog pic!</p>\n<p>Okay, let&#39;s tweak it minorly.</p>\n<pre><code class=\"hljs language-display-html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;dog-btn&quot;</span>&gt;</span>Gimme Doggo<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;dog-target&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n</code></pre>\n<p><button id=\"dog-btn2\">Gimme Doggo</button></p>\n<div id=\"dog-target2\"></div>\n\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">DOG_URL</span> = <span class=\"hljs-string\">&quot;https://dog.ceo/api/breeds/image/random&quot;</span>;\n\n<span class=\"hljs-keyword\">const</span> doggos = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&quot;dog-target2&quot;</span>);\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">addNewDoggo</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">const</span> promise = <span class=\"hljs-title function_\">fetch</span>(<span class=\"hljs-variable constant_\">DOG_URL</span>);\n  promise\n    .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">response</span>) {\n      <span class=\"hljs-keyword\">const</span> processingPromise = response.<span class=\"hljs-title function_\">json</span>(); <span class=\"hljs-comment\">// json instead of text</span>\n      <span class=\"hljs-keyword\">return</span> processingPromise;\n    })\n    .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">processedResponse</span>) {\n      <span class=\"hljs-comment\">// we get to skip this line since it&#x27;ll already be an object</span>\n      <span class=\"hljs-comment\">// const dogObject = JSON.parse(processedResponse);</span>\n\n      <span class=\"hljs-keyword\">const</span> img = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">&quot;img&quot;</span>);\n      img.<span class=\"hljs-property\">src</span> = processedResponse.<span class=\"hljs-property\">message</span>;\n      img.<span class=\"hljs-property\">alt</span> = <span class=\"hljs-string\">&quot;Cute doggo&quot;</span>;\n      doggos.<span class=\"hljs-title function_\">appendChild</span>(img);\n    });\n}\n\n<span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&quot;dog-btn2&quot;</span>).<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&quot;click&quot;</span>, addNewDoggo);\n</code></pre>\n<p>A slight difference, but if we know we&#39;re going to get JSON back from the API, fetch can do the parsing directly for you with the <code>json()</code> function.</p>\n","slug":"ajax","title":"AJAX","section":"Talking to Servers","icon":"code-compare","filePath":"/home/runner/work/complete-intro-to-web-dev-v3/complete-intro-to-web-dev-v3/lessons/06-talking-to-servers/B-ajax.md","nextSlug":"/complete-intro-to-web-dev-v3/lessons/talking-to-servers/async-await","prevSlug":"/complete-intro-to-web-dev-v3/lessons/talking-to-servers/json"}},"__N_SSG":true}